>
>
>本文是由笔者总结的笔记，来源自北大余肇飞老师：【20220112【脉络分明：脉冲神经网络及其应用】余肇飞：脉冲神经网络学习理论与方法】 https://www.bilibili.com/video/BV1uT4y127Zr/?share_source=copy_web&vd_source=11da79c1d1fa9faeb59d46943aa4fa9e

# RSNN

RSNN（Recurrent Spiking Neural Network，**循环脉冲神经网络**）是一类**结合了生物神经元脉冲特性SNN**和**循环结构RNN**的神经网络，广泛用于处理时间序列、语音识别、脑机接口等任务。

## 脉冲神经元模型

前置知识

| <img src="markdown-img/脉冲神经网络.assets/neural_structure.jpg" alt="neural_structure" style="zoom: 50%;" /> | <img src="markdown-img/脉冲神经网络.assets/image-20250622194751970.png" alt="image-20250622194751970" style="zoom:150%;" /> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

脉冲神经元主要包含胞体、树突和轴突。

+ 树突：信息传来的通路

+ 胞体：类似CPU，**信息传来->充电->达阈值->放电**

+ 轴突：传给其他神经元的通路

  

其中，神经元信息传递主要通过脉冲。

![image-20250622195103673](markdown-img/脉冲神经网络.assets/image-20250622195103673.png)

前一个神经元发放一个脉冲，就会传给下一个神经元，电压累积。若发来多个脉冲**，电压累积到阈值，就发放一个脉冲给下一个神经元**。



## 数学模型描述

### 微分方程

![image-20250622195739277](markdown-img/脉冲神经网络.assets/image-20250622195739277.png)

### 仿真离散的差分方程

![image-20250622195811804](markdown-img/脉冲神经网络.assets/image-20250622195811804.png)

### 流程

![image-20250622200737017](markdown-img/脉冲神经网络.assets/image-20250622200737017.png)

1. 充电
   $$
   H_t = f(V_{t-1}, X_t)
   $$
   对LIF模型
   $$
   H_t = \left(1 - \frac{1}{\tau} \right) V_{t-1} + \frac{1}{\tau} X_t
   $$
   对IF模型
   $$
   H_t = V_{t-1} + \frac{1}{\tau} X_t
   $$

其中**τ（tau）是一个关键的时间常数**，代表**膜电位衰减的快慢**。

**τ 大：神经元“记性好”**，膜电位衰减得慢，信息保留时间更长。

**τ 小：神经元“记性差”**，膜电位很快就回到初始状态。

2. 放电
   $$
   S_t = \Theta(H_t - V{th})
   $$

   $$
   \quad = \begin{cases}  
   1, & H_t \geq V_{th} \\  
   0, & H_t < V_{th}  
   \end{cases}
   $$

   电压累积到阈值，St置为1。

3. 重置

   + 硬重置

     膜电位直接被重置为Vreset
     $$
     V_t = S_t V_{reset} + (1 - S_t) H_t
     $$

   + 软重置

     膜电位减少Vth
     $$
     V_t = V_t - S_t V_{th}
     $$
     

## 学习方法

### 梯度替代法

由于BP算法训练，放电函数是单位阶跃函数，不可微，在x=0处导数无穷大。于是**在反向传播时，用一个新函数替代原放电函数**。前向传播保持不变。

前向传播：
$$
\Theta(x) = \begin{cases}  
1, & x \geq 0 \\  
0, & x < 0  
\end{cases}
$$
后向传播：
$$
\Theta'(x) \triangleq g'(x)
$$
如
$$
g(x) = \dfrac{1}{1 + \exp(-\alpha x)}
$$
具体流程（surrogate gradient 方法）

1. 前向传播：
   - 更新膜电位
   - 判断是否发放脉冲
   - 记录 spike 时间序列
2. 计算 loss（比如输出 spike 序列和目标序列的 MSE）
3. 反向传播：
   - 展开所有时间步（BPTT）
   - 用 surrogate gradient 估计每一层的脉冲函数的导数
   - 更新权重